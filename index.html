<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Black Tie Gala - Audience Hub</title>
    <script>
      window.FIREBASE_CONFIG = {
        apiKey: "AIzaSyCcR537OUiw_M9iy29em6kBGfn-z7Tf7-8",
        authDomain: "gala-99db5.firebaseapp.com",
        projectId: "gala-99db5",
        storageBucket: "gala-99db5.firebasestorage.app",
        messagingSenderId: "75610830408",
        appId: "1:75610830408:web:111f50ea866528ac5a8a7d",
        measurementId: "G-7P75W73C4B"
      };
      window.EVENT_ID = "black-tie-gala-2026-02-09";
    </script>
    <style>
      :root {
        --bg-1: #0b0d12;
        --bg-2: #161b24;
        --bg-3: #0f141c;
        --gold-1: #f6d67b;
        --gold-2: #c9a44d;
        --ink: #e9eef6;
        --muted: #a6b3c6;
        --card: rgba(17, 20, 28, 0.85);
        --stroke: rgba(255, 255, 255, 0.08);
        --shadow: 0 20px 50px rgba(0, 0, 0, 0.45);
        --aud: #5fd6a6;
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        color: var(--ink);
        font-family: "Fraunces", "Iowan Old Style", "Palatino Linotype", "Book Antiqua", "Times New Roman", serif;
        background:
          radial-gradient(1200px 600px at 80% -20%, rgba(246, 214, 123, 0.12), transparent 60%),
          radial-gradient(800px 500px at 10% 10%, rgba(255, 138, 91, 0.12), transparent 60%),
          linear-gradient(160deg, var(--bg-1), var(--bg-2) 40%, var(--bg-3));
        min-height: 100vh;
      }
      main { max-width: 1050px; margin: 0 auto; padding: 34px 16px 50px; }
      header { text-align: center; margin-bottom: 20px; }
      h1 { margin: 0 0 8px; font-size: clamp(2rem, 4vw, 3rem); letter-spacing: 0.04em; }
      header p { margin: 0; color: var(--muted); font-family: "Work Sans", "Segoe UI", Arial, sans-serif; }
      .scoreline {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 14px;
        font-family: "Work Sans", "Segoe UI", Arial, sans-serif;
        color: var(--muted);
      }
      .scoreline strong { color: var(--ink); }
      .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 14px; }
      .card {
        background: var(--card);
        border: 1px solid var(--stroke);
        border-radius: 16px;
        box-shadow: var(--shadow);
        padding: 16px;
        display: grid;
        gap: 10px;
      }
      .card h2 { margin: 0; font-size: 1.25rem; }
      .card p { margin: 0; color: var(--muted); font-family: "Work Sans", "Segoe UI", Arial, sans-serif; font-size: 0.95rem; }
      .status {
        width: fit-content;
        border: 1px solid var(--stroke);
        border-radius: 999px;
        padding: 4px 10px;
        font-family: "Work Sans", "Segoe UI", Arial, sans-serif;
        font-size: 0.75rem;
        color: var(--muted);
      }
      .status.open { color: var(--aud); border-color: rgba(95, 214, 166, 0.45); }
      .actions { display: flex; flex-wrap: wrap; gap: 8px; }
      .hidden { display: none; }
      a.button {
        text-decoration: none;
        color: #151515;
        background: linear-gradient(135deg, var(--gold-1), var(--gold-2));
        border-radius: 10px;
        padding: 9px 12px;
        font-family: "Work Sans", "Segoe UI", Arial, sans-serif;
        font-weight: 600;
      }
      a.button.locked { pointer-events: none; opacity: 0.45; filter: grayscale(0.4); }
      .qr-corner {
        position: fixed;
        right: 12px;
        bottom: 12px;
        width: 128px;
        padding: 8px;
        border-radius: 12px;
        border: 1px solid var(--stroke);
        background: rgba(10, 12, 18, 0.9);
        box-shadow: var(--shadow);
        z-index: 999;
      }
      .qr-corner img { width: 100%; height: auto; display: block; border-radius: 8px; }
      .qr-corner .qr-label {
        margin-bottom: 6px;
        text-align: center;
        color: var(--muted);
        font-family: "Work Sans", "Segoe UI", Arial, sans-serif;
        font-size: 0.72rem;
      }
    </style>
  </head>
  <body>
    <main>
      <header>
        <h1>Black Tie Gala</h1>
        <p>Audience and contestant game access.</p>
      </header>
      <div class="scoreline">
        <span>Contestant Points: <strong id="score-host">0</strong></span>
        <span>Audience Points: <strong id="score-aud">0</strong></span>
      </div>

      <section class="grid">
        <article class="card" data-game="anagrams">
          <div class="status" data-status>Locked</div>
          <h2>Anagrams</h2>
          <p>Mix the letters to make a word.</p>
          <div class="actions">
            <a class="button locked" data-link-audience href="anagram.html?role=audience">Audience Link</a>
            <a class="button locked" data-link-contestant href="anagram.html?role=contestant&id=contestant-1">Contestants Link</a>
          </div>
        </article>
        <article class="card" data-game="wordle">
          <div class="status" data-status>Locked</div>
          <h2>Wordle</h2>
          <p>Have you never played Wordle?</p>
          <div class="actions">
            <a class="button locked" data-link-audience href="wordle.html?role=audience">Audience Link</a>
            <a class="button locked" data-link-contestant href="wordle.html?role=contestant&id=contestant-1">Contestants Link</a>
          </div>
        </article>
        <article class="card" data-game="word_ladder">
          <div class="status" data-status>Locked</div>
          <h2>Word Ladder</h2>
          <p>Word the Ladder.</p>
          <div class="actions">
            <a class="button locked" data-link-audience href="ladder.html?role=audience">Audience Link</a>
            <a class="button locked" data-link-contestant href="ladder.html?role=contestant&id=contestant-1">Contestants Link</a>
          </div>
        </article>
        <article class="card" data-game="final_game">
          <div class="status" data-status>Locked</div>
          <h2>The Final Game</h2>
          <p>Its the end.</p>
          <div class="actions">
            <a class="button locked" data-link-audience href="final.html?role=audience">Audience Link</a>
          </div>
        </article>
      </section>
    </main>
    <div class="qr-corner">
      <div class="qr-label">Scan This Page</div>
      <img src="qr.png" alt="QR code" />
    </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
      import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

      const params = new URLSearchParams(location.search);
      const contestantAccessId = window.CONTESTANT_ACCESS_ID || "contestant-1";
      const isContestantViewer = params.get("id") === contestantAccessId;
      const hideFinalForContestant = isContestantViewer;

      const app = initializeApp(window.FIREBASE_CONFIG);
      const db = getFirestore(app);
      const locksRef = doc(db, "events", window.EVENT_ID, "gameLocks", "state");
      const scoreRef = doc(db, "events", window.EVENT_ID, "scoreboard", "global");
      const scoreHost = document.getElementById("score-host");
      const scoreAud = document.getElementById("score-aud");
      document.querySelectorAll("[data-game]").forEach((card) => {
        const audienceLink = card.querySelector("[data-link-audience]");
        const contestantLink = card.querySelector("[data-link-contestant]");
        if (!audienceLink || !contestantLink) return;
        if (isContestantViewer) {
          audienceLink.textContent = "Contestant Link";
          audienceLink.href = contestantLink.href;
        }
        contestantLink.classList.add("hidden");
      });

      const setLock = (game, unlocked) => {
        document.querySelectorAll(`[data-game="${game}"] [data-status]`).forEach((el) => {
          el.textContent = unlocked ? "Unlocked" : "Locked";
          el.classList.toggle("open", unlocked);
        });
        document.querySelectorAll(`[data-game="${game}"] a.button`).forEach((el) => {
          el.classList.toggle("locked", !unlocked);
        });
        if (game === "final_game") {
          document.querySelectorAll(`[data-game="${game}"]`).forEach((el) => {
            el.classList.toggle("hidden", hideFinalForContestant || !unlocked);
          });
        }
      };

      onSnapshot(locksRef, (snap) => {
        const d = snap.data() || {};
        setLock("anagrams", !!d.anagrams);
        setLock("wordle", !!d.wordle);
        setLock("word_ladder", !!d.word_ladder);
        setLock("final_game", !!d.final_game);
      });

      onSnapshot(scoreRef, (snap) => {
        const d = snap.data() || {};
        scoreHost.textContent = String(d.pointsContestants || 0);
        scoreAud.textContent = String(d.pointsAudience || 0);
      });
    </script>
  </body>
</html>
